<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Matheus Silva | Mordomo</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="projeto-style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" />
</head>
<body class="pagina-projeto">

    <header class="header">
        <nav class="navbar container">
            <a href="../index.html" class="logo gradient-text">Matheus Silva</a>
            <ul class="nav-menu">
                <li class="nav-item"><a href="../index.html#sobre" class="nav-link">Sobre</a></li>
                <li class="nav-item"><a href="../index.html#formacao" class="nav-link">Formação</a></li>
                <li class="nav-item"><a href="../index.html#projetos" class="nav-link">Projetos</a></li>
                <li class="nav-item"><a href="../index.html#contato" class="nav-link">Contato</a></li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    </header>

    <main>
        <section class="projeto-hero gsap-fade-in">
            <div class="container">
                <span class="breadcrumb"><a href="../index.html#projetos">Projetos</a> /</span>
                <h1>Mordomo</h1>
                <p class="projeto-subtitulo">Interface gráfica (PyQt5) para automação centralizada de downloads e relatórios de múltiplos portais financeiros.</p>
            </div>
        </section>

        <div class="container gsap-fade-in">
            <img src="../assets/images/mordomo1.png" alt="Interface Principal da Aplicação Mordomo" class="projeto-imagem-destaque">
        </div>

        <section class="projeto-conteudo gsap-fade-in">
            <div class="container">
                
                <div class="projeto-descricao">
                    <h2>O Desafio</h2>
                    <p>A necessidade de baixar relatórios de diversos portais web financeiros (Função, Credbase, Dig, Front) diariamente era um processo manual, demorado e propenso a erros. Cada portal possuía fluxos de login e navegação distintos, e o gerenciamento seguro de múltiplas credenciais era complexo e ineficiente.</p>
                    <p>Era crucial desenvolver uma solução centralizada que permitisse aos usuários configurar e executar essas automações de forma simples e segura, com feedback visual claro do progresso e capacidade de lidar com cenários como autenticação de dois fatores (2FA).</p>

                    <h2>A Solução: Mordomo</h2>
                    <p>Desenvolvi o "Mordomo", uma aplicação desktop completa utilizando Python e a biblioteca PyQt5 para a interface gráfica. A aplicação foi projetada para oferecer uma experiência robusta e amigável:</p>
                    <ul class="lista-detalhada">
                        <li><strong>Interface Gráfica Intuitiva (PyQt5):</strong> Design limpo com modos "Tarefa Única" e "Power Mode" para execução sequencial de múltiplas tarefas, facilitando o uso por qualquer membro da equipe.</li>
                        <li><strong>Automação Web Robusta (Selenium):</strong> Utiliza Selenium e `webdriver-manager` para interagir com os portais (Função, Credbase, Dig, Front), garantindo compatibilidade entre navegadores/drivers e dispensando instalações manuais.</li>
                        <li><strong>Gerenciador de Logins Seguro (QSettings):</strong> Armazena credenciais por site de forma segura no sistema operacional (Registro/Windows, plist/macOS, ini/Linux), ofuscadas com Base64 para proteção adicional.</li>
                        <li><strong>Orquestração de Tarefas (QThread):</strong> Um `AutomationOrchestrator` gerencia a fila de execução e executa cada worker (automação específica do site) em uma thread separada, mantendo a interface responsiva.</li>
                        <li><strong>Suporte a 2FA (Credbase):</strong> Lida especificamente com o fluxo de autenticação de dois fatores do portal Credbase, pausando a automação e solicitando o código ao usuário através da interface.</li>
                        <li><strong>Feedback em Tempo Real:</strong> Um console de log na interface exibe o progresso detalhado, sucessos e eventuais erros de cada tarefa.</li>
                        <li><strong>Componentes Customizados (PyQt5):</strong> Widgets como `SearchableComboBox` (ComboBox com busca) melhoram significativamente a usabilidade na seleção de convênios em listas extensas.</li>
                    </ul>

                    <h2>Interface e Funcionalidades</h2>
                    <p>Screenshots do gerenciador de logins e do modo "Power Mode" configurando múltiplas tarefas.</p>
                    <div class="galeria-grid">
                        <figure>
                            <img src="../assets/images/mordomo2.png" alt="Gerenciador de Logins do Mordomo">
                            <figcaption>Gerenciador de Logins: Permite salvar e reutilizar credenciais de forma segura para cada site.</figcaption>
                        </figure>
                        <figure>
                            <img src="../assets/images/mordomo3.png" alt="Configuração do Modo Tarefa Única">
                            <figcaption>Modo Tarefa Única: Interface simples para configurar e executar uma automação específica.</figcaption>
                        </figure>
                         <figure>
                            <img src="../assets/images/mordomo4.png" alt="Configuração do Power Mode">
                            <figcaption>Power Mode: Permite configurar e executar múltiplas tarefas em sequência.</figcaption>
                        </figure>
                    </div>

                    <h2>Código em Destaque</h2>
                    <p>Trecho de um worker (ex: `FuncaoRelatorioPrincipalWorker`) mostrando a inicialização do Selenium em modo "headless" (sem interface gráfica visível do navegador) e o uso de `webdriver-manager` para baixar automaticamente o driver correto, garantindo a portabilidade da aplicação.</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <i data-feather="file-text"></i>
                            <span>automation/sites/funcao.py (Worker Init)</span>
                        </div>
<pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
from PyQt5.QtCore import QObject, pyqtSignal

class FuncaoRelatorioPrincipalWorker(QObject):
    progress_updated = pyqtSignal(str)
    finished = pyqtSignal()

    def __init__(self, usuario, senha, data_ini, data_fim, empregadores, task_index=0, total_tasks=1):
        super().__init__()
        self.is_running = True

        try:
            self.progress_updated.emit("&gt;&gt;&gt; Inicializando WebDriver...")
            service = Service(ChromeDriverManager().install())
            
            options = webdriver.ChromeOptions()
            options.add_argument("--headless") 
            options.add_argument("--window-size=1920,1080")
            options.add_argument("--disable-gpu")
            options.add_argument("--no-sandbox")
            options.add_argument("--disable-dev-shm-usage")

            self.driver = webdriver.Chrome(service=service, options=options)
            self.progress_updated.emit("&gt;&gt;&gt; WebDriver inicializado com sucesso em modo Headless.")
            
        except Exception as e:
            self.progress_updated.emit(f"ERRO: Falha ao inicializar WebDriver: {e}")
            self.is_running = False
    
</code></pre>
                    </div> 
                </div> 
                
                <aside class="projeto-sidebar">
                    <div class="sidebar-box">
                        <h3>Tecnologias Principais</h3>
                        <ul class="tech-list">
                            <li><i data-feather="check"></i> Python</li>
                            <li><i data-feather="check"></i> PyQt5 (GUI)</li>
                            <li><i data-feather="check"></i> Selenium (RPA Web)</li>
                            <li><i data-feather="check"></i> Webdriver-Manager</li>
                            <li><i data-feather="check"></i> Pandas</li>
                            <li><i data-feather="check"></i> QSettings</li>
                            <li><i data-feather="check"></i> QThread</li>
                            <li><i data-feather="check"></i> Base64</li>
                        </ul>
                    </div>
                    <div class="sidebar-box">
                        <h3>Tipo de Projeto</h3>
                        <p>Aplicação Desktop / Automação (RPA) / ETL</p>
                    </div>
                    <div class="sidebar-box">
                        <h3>Contexto</h3>
                        <p>Ferramenta Interna (Capital Consig)</p>
                    </div>
                    <div class="sidebar-box">
                        <h3>Resultados Chave</h3>
                         <ul class="tech-list">
                            <li><i data-feather="check"></i> Centralização da automação de 4 portais.</li>
                            <li><i data-feather="check"></i> Redução drástica no tempo de execução.</li>
                            <li><i data-feather="check"></i> Eliminação de erros manuais nos downloads.</li>
                            <li><i data-feather="check"></i> Gerenciamento seguro de credenciais.</li>
                            <li><i data-feather="check"></i> Interface amigável para usuários não técnicos.</li>
                            <li><i data-feather="check"></i> Tratamento robusto de sessões e 2FA.</li>
                        </ul>
                    </div>
                </aside> 
            </div> 
        </section> 
    </main>

    <footer class="footer">
        <div class="container">
            <p>© 2025 Matheus Silva. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    
    <script src="../script.js"></script>
    <script src="projeto-script.js"></script>
    
    <script>
        feather.replace();
    </script>
    
</body>
</html>