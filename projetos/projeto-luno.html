<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Matheus Silva | Luno</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="projeto-style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" />
</head>
<body class="pagina-projeto">

    <header class="header">
        <nav class="navbar container">
            <a href="../index.html" class="logo gradient-text">Matheus Silva</a>
            <ul class="nav-menu">
                <li class="nav-item"><a href="../index.html#sobre" class="nav-link">Sobre</a></li>
                <li class="nav-item"><a href="../index.html#formacao" class="nav-link">Formação</a></li>
                <li class="nav-item"><a href="../index.html#projetos" class="nav-link">Projetos</a></li>
                <li class="nav-item"><a href="../index.html#contato" class="nav-link">Contato</a></li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    </header>

    <main>
        <section class="projeto-hero gsap-fade-in">
            <div class="container">
                <span class="breadcrumb"><a href="../index.html#projetos">Projetos</a> /</span>
                <h1>Luno</h1>
                <p class="projeto-subtitulo">Aplicação desktop (PyQt5) para criação e gestão automatizada de escalas de trabalho semanais para farmácias.</p>
            </div>
        </section>

        <div class="container gsap-fade-in">
            <img src="../assets/images/luno4.png" alt="Exemplo de Escala Gerada pelo Luno" class="projeto-imagem-destaque">
        </div>

        <section class="projeto-conteudo gsap-fade-in">
            <div class="container">
                
                <div class="projeto-descricao">
                    <h2>O Desafio</h2>
                    <p>A criação manual de escalas de rotinas semanais em farmácias é uma tarefa complexa e demorada. É preciso conciliar as rotinas específicas de cada turno e grupo de trabalho com as folgas individuais dos funcionários, garantindo a cobertura de todas as tarefas e uma distribuição justa.</p>
                    <p>Fazer isso manualmente, muitas vezes em planilhas, é propenso a erros, difícil de manter e consome um tempo valioso que poderia ser dedicado a outras atividades da farmácia.</p>

                    <h2>A Solução: Aplicação Desktop Luno</h2>
                    <p>Desenvolvi o "Luno", uma aplicação desktop em Python com interface gráfica PyQt5, projetada para simplificar e automatizar a geração de escalas de rotinas em farmácias:</p>
                    <ul class="lista-detalhada">
                        <li><strong>Gestão Centralizada:</strong> Permite cadastrar funcionários (manually ou via importação Excel), definir seus grupos de trabalho (cores) e gerenciar rotinas específicas para cada turno e grupo (salvas em JSON).</li>
                        <li><strong>Gerenciador de Folgas:</strong> Interface dedicada para registrar os dias de folga fixos de cada funcionário, salvando os dados em formato JSON para persistência.</li>
                        <li><strong>Dois Modos de Geração:</strong>
                            <ul>
                                <li><em>Grupos Fixos (Manual):</em> Aloca funcionários às rotinas baseando-se estritamente no grupo de cor definido, rotacionando dentro do grupo para evitar sobrecarga e respeitando folgas.</li>
                                <li><em>Rotação Diária (Automático):</em> Distribui aleatoriamente os funcionários disponíveis (sem folga no dia) entre os grupos de rotinas ativos, garantindo cobertura e variação.</li>
                            </ul>
                        </li>
                        <li><strong>Visualização Clara da Escala:</strong> Apresenta a escala semanal gerada numa tabela (QTableWidget) colorida de acordo com os grupos, facilitando a visualização.</li>
                        <li><strong>Fixação Manual (Pinning):</strong> Permite ao usuário clicar com o botão direito numa célula da escala e "fixar" um funcionário específico para aquela rotina/dia, sobrepondo a geração automática.</li>
                        <li><strong>Importação/Exportação Excel:</strong> Facilita a entrada de dados (funcionários, rotinas via Excel) e a partilha da escala final gerada (formato Excel).</li>
                        <li><strong>Interface Personalizada:</strong> Utiliza um stylesheet customizado (`ui_design.py`) e ícones SVG para um visual moderno e agradável, focado na usabilidade.</li>
                    </ul>

                    <h2>Interface da Aplicação Luno</h2>
                    <p>Visualização das principais telas: configuração inicial, gerenciador de rotinas e gerenciador de folgas.</p>
                    <div class="galeria-grid">
                        <figure>
                            <img src="../assets/images/luno1.png" alt="Tela inicial do Luno">
                            <figcaption>Tela principal da aplicação, com painel de controle à esquerda.</figcaption>
                        </figure>
                        <figure>
                            <img src="../assets/images/luno2.png" alt="Gerenciador de Rotinas">
                            <figcaption>Janela modal para adicionar, editar, remover e importar rotinas por turno e grupo.</figcaption>
                        </figure>
                        <figure>
                            <img src="../assets/images/luno3.png" alt="Gerenciador de Folgas">
                            <figcaption>Janela modal para definir os dias de folga fixos de cada funcionário.</figcaption>
                        </figure>
                        </div>

                    <h2>Código em Destaque</h2>
                    <p>Trecho do `main_app.py` que implementa a lógica de geração da escala no modo "Grupos Fixos". Ele utiliza `deque` para rotacionar os funcionários dentro de cada grupo e verifica as folgas (`days_off_data`) antes de alocar um funcionário a uma célula da escala.</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <i data-feather="file-text"></i>
                            <span>main_app.py (Geração - Grupos Fixos)</span>
                        </div>
<pre><code class="language-python">
from collections import deque

class PharmacyScheduler(QMainWindow):

    def generate_with_fixed_groups(self):
        group_deques = {group: deque(sorted([name for name, g in self.employees.items() if g == group])) 
                        for group in GROUP_COLORS}
        
        for day_idx, day in enumerate(DAYS_OF_WEEK):
            col_idx = day_idx + 1
            
            for row_idx in range(self.schedule_table.rowCount()):
                routine_group = self.routine_map[row_idx] 
                found_employee = None
                
                if group_deques[routine_group]:
                    for _ in range(len(group_deques[routine_group])):
                        candidate = group_deques[routine_group][0]
                        if day not in self.days_off_data.get(candidate, []):
                            found_employee = candidate
                            break
                        
                        group_deques[routine_group].rotate(-1) 
                        
                employee_name = found_employee
                
                if (row_idx, col_idx) in self.pinned_assignments:
                    employee_name = self.pinned_assignments[(row_idx, col_idx)]
                    
                if employee_name:
                    self.set_table_cell(row_idx, col_idx, employee_name, routine_group)
            
            for group in group_deques:
                if group_deques[group]: 
                    group_deques[group].rotate(-1)
    
</code></pre>
                    </div> 
                </div> 
                
                <aside class="projeto-sidebar">
                    <div class="sidebar-box">
                        <h3>Tecnologias Principais</h3>
                        <ul class="tech-list">
                            <li><i data-feather="check"></i> Python</li>
                            <li><i data-feather="check"></i> PyQt5 (GUI)</li>
                            <li><i data-feather="check"></i> JSON (Persistência)</li>
                            <li><i data-feather="check"></i> Pandas (Import/Export)</li>
                            <li><i data-feather="check"></i> Openpyxl</li>
                            <li><i data-feather="check"></i> Algoritmos de Escala</li>
                            <li><i data-feather="check"></i> `collections.deque`</li>
                        </ul>
                    </div>
                    <div class="sidebar-box">
                        <h3>Tipo de Projeto</h3>
                        <p>Aplicação Desktop / Ferramenta de Gestão / Scheduling</p>
                    </div>
                    <div class="sidebar-box">
                        <h3>Contexto</h3>
                        <p>Projeto Pessoal (para Farmácia)</p>
                    </div>
                    <div class="sidebar-box">
                        <h3>Resultados Chave</h3>
                        <ul class="tech-list">
                            <li><i data-feather="check"></i> Automação completa da criação de escalas.</li>
                            <li><i data-feather="check"></i> Redução de tempo e erros no agendamento.</li>
                            <li><i data-feather="check"></i> Flexibilidade com dois modos de geração.</li>
                            <li><i data-feather="check"></i> Gestão centralizada de dados.</li>
                            <li><i data-feather="check"></i> Exportação para Excel.</li>
                            <li><i data-feather="check"></i> Interface gráfica amigável.</li>
                        </ul>
                    </div>
                </aside> 
            </div> 
        </section> 
    </main>

    <footer class="footer">
        <div class="container">
            <p>© 2025 Matheus Silva. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    
    <script src="../script.js"></script>
    <script src="projeto-script.js"></script>
    
    <script>
        feather.replace();
    </script>
    
</body>
</html>